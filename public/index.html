<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<title>OpenSpots | Smart Sensors. Smart Parking.</title>
  <link rel="icon" type="image/png" href="assets/Facebook Profile Picture.png" />
<link rel="stylesheet" href="style.css" />
</head>
<body>

<header>
  <div class="brand-left"><h1>OpenSpots</h1></div>
  <img src="assets/Facebook Profile Picture.png" alt="OpenSpots Logo" class="logo-center">
  <nav>
    <ul>
      <li><a href="about.html">About Us</a></li>
      <li><a href="contact.html">Contact</a></li>
      <li>
            <a href="coming-soon-app.html" class="nav-coming-soon"> Coming Soon 
            <img src="assets/app vector.png" alt="App Icon" class="nav-icon">
            </a>
      </li>
      <li><a href="login.html" class="button">Log In / Sign Up</a></li>
    </ul>
  </nav>
  <div class="hamburger" onclick="toggleMenu()"><span></span><span></span><span></span></div>
</header>

<!-- Hero -->
<section class="hero">
  <div>
    <img src="assets/Parking Sensor.png" alt="Parking lot placeholder">
  </div>
  <div class="hero-text">
    <h2>Guaranteed Parking. Before or When You Arrive.</h2>
    <p>OpenSpots lets you reserve verified parking spots in advance or find real-time availability nearby — all powered by smart sensors. No guessing. No circling. Your spot is ready when you arrive.</p>

    <!-- Widget -->
    <div class="widget">
      <div class="tabs">
        <button class="active" id="reserveTab">Reserve</button>
        <button id="nearbyTab">Nearby</button>
      </div>

      <!-- Reserve Tab -->
      <div id="reserveForm">
        <select id="category">
          <option selected disabled>Choose Venue or Airport...</option>
        </select>

        <select id="eventList" disabled>
          <option selected>Choose an event...</option>
        </select>

        <div id="airportSection" style="display:none;">
  <label for="citySelect">City:</label>
  <select id="citySelect">
    <option selected disabled>Choose City...</option>
  </select>

  <label for="airportName">Airport:</label>
  <select id="airportName" disabled>
    <option selected disabled>Choose Airport...</option>
  </select>

  <label for="arriveDate">Parking Start:</label>
  <input type="datetime-local" id="arriveDate" name="arriveDate">

  <label for="departDate">Parking End:</label>
  <input type="datetime-local" id="departDate" name="departDate">

  <small class="hint-text">Select when you’ll leave your car and when you’ll return.</small>

</div>


        <button id="reserveBtn" disabled>Reserve My Spot</button>
      </div>

      <!-- Nearby Tab -->
      <div id="nearbyForm" style="display:none;">
        <select id="radius">
          <option selected>Select Range</option>
          <option value="1">Within 1 Mile</option>
          <option value="3">Within 3 Miles</option>
          <option value="5">Within 5 Miles</option>
        </select>
        <button id="findBtn">Find Open Spots</button>
      </div>
    </div>
  </div>
</section>

<!-- Features -->
<section class="feature">
  <div>
    <h3>Partner With Us</h3>
    <p>Turn your lot into revenue. Make parking stress-free at your venue while boosting your income with OpenSpots.</p>
    <a href="contact.html">Partner With Us</a>
  </div>
  <img src="assets/partner.png" alt="Partner With Us">
</section>

<section class="feature reverse">
  <img src="assets/environment.png" alt="Environmental Impact">
  <div>
    <h3>Environmental Impact</h3>
    <p>
      Less circling, fewer emissions, smarter cities. Every reserved spot reduces congestion, idle time, and CO₂ output. 
      OpenSpots helps drivers find the nearest available parking fast — saving time while supporting cleaner urban mobility.
    </p>
    <a href="about.html#greener-future" class="btn-primary">Learn More</a>
  </div>
</section>

<section class="feature">
  <div>
    <h3>Safety & Reliability</h3>
    <p>Your spot is always guaranteed and verified by sensors. No scams, no stress — just parking that works.</p>
    <a href="about.html#how-it-works" class="btn-primary">Safety & Reliability</a>
  </div>
  <img src="assets/Safety.png" alt="Safety and Reliability">
</section>

<section class="feature reverse">
  <img src="assets/ai-future.png" alt="Coming Soon OpenSpots.AI">
  <div>
    <h3>Coming Soon: OpenSpots.AI</h3>
    <p>The future of parking is smarter than ever. Our next evolution will connect sensors, predict openings, and guide you to the best spot before it’s even free.</p>
    <a href="coming-soon-ai.html">See What’s Coming</a>
  </div>
</section>


  <!-- Footer -->
  <footer>
    <div class="footer-container">
      <div class="footer-brand">
        <img src="assets/Facebook Profile Picture.png" alt="OpenSpots Logo" class="footer-logo">
        <p><strong>OpenSpots</strong> | Smarter Parking with Sensors</p>
        <p>Powered by AI & IoT • Est. 2025</p>
      </div>

      <div class="footer-links">
        <div>
          <h4>Book Parking</h4>
          <ul><li><a href="contact.html">Event Parking</a></li><li><a href="contact.html">Airport Parking</a></li></ul>
        </div>
        <div>
          <h4>Partners</h4>
          <ul><li><a href="contact.html">Become a Partner</a></li><li><a href="contact.html">Venues & Events</a></li></ul>
        </div>
        <div>
          <h4>Company</h4>
          <ul><li><a href="about.html">About Us</a></li><li><a href="contact.html">Contact</a></li></ul>
        </div>
        <div>
          <h4>Legal</h4>
          <ul>
            <li><a href="terms.html">Terms &amp; Conditions</a></li>
            <li><a href="privacy.html">Privacy Policy</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-social">
  <h4>Follow Us</h4>
  <div class="social-icons">
    <a href="https://instagram.com/openspotsapp" target="_blank">
      <img src="assets/badge instagram.png" alt="Instagram" />
    </a>
    <a href="https://twitter.com/openspotsapp" target="_blank">
      <img src="assets/badge X.png" alt="Twitter/X" />
    </a>
    <a href="https://tiktok.com/@openspotsapp" target="_blank">
      <img src="assets/badge tiktok.png" alt="TikTok" />
    </a>
    <a href="https://youtube.com/@openspotsapp" target="_blank">
      <img src="assets/badge youtube.png" alt="YouTube" />
    </a>
    <a href="mailto:contact@openspots.app">
      <img src="assets/badge email.png" alt="Email" />
    </a>
  </div>
</div>

    </div>
    <div class="footer-bottom">
      <p>© OpenSpots 2025. All Rights Reserved.</p>
    </div>
  </footer>

<script type="module" src="app.js"></script>
<script type="module">
  import {
    getFirestore,
    collection,
    query,
    where,
    getDocs,
    doc
  } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
  import {
    getAuth,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
  import { app } from "./firebase-init.js";

  const db = getFirestore(app);
  const auth = getAuth(app);
  let currentUser = null;

  onAuthStateChanged(auth, (user) => {
    currentUser = user;
  });

  const category     = document.getElementById('category');
  const eventList    = document.getElementById('eventList');
  const airportDates = document.getElementById('airportDates');
  const reserveBtn   = document.getElementById('reserveBtn');
  const citySelect   = document.getElementById("citySelect");
  const airportName  = document.getElementById("airportName");
  const airportSection = document.getElementById("airportSection");

  async function loadEventsForVenue(venueId) {
    eventList.innerHTML = `<option selected disabled>Choose an event...</option>`;
    eventList.disabled = true;

    const venueRef = doc(db, "venues", venueId);
    const eventsSnap = await getDocs(
      query(
        collection(db, "events"),
        where("venue_ref", "==", venueRef),
        where("is_active", "==", true),
        where("event_date", ">=", new Date())
      )
    );

    eventsSnap.forEach(docSnap => {
      const ev = docSnap.data();
      const opt = document.createElement("option");
      opt.value = docSnap.id;
      const eventDate = ev.event_date.toDate();
      opt.textContent = `${ev.event_name} — ${eventDate.toLocaleDateString()}`;
      eventList.appendChild(opt);
    });

    eventList.disabled = false;
  }

  async function loadVenues() {
    category.innerHTML = `<option selected disabled>Choose Venue or Airport...</option>`;

    const venuesSnap = await getDocs(
      query(collection(db, "venues"), where("is_active", "==", true))
    );

    venuesSnap.forEach(docSnap => {
      const v = docSnap.data();
      const opt = document.createElement("option");
      opt.value = docSnap.id;
      opt.textContent = v.name;
      opt.dataset.type = v.venue_type; // stadium | airport | private
      category.appendChild(opt);
    });
  }

  async function loadAirports(city) {
    airportName.innerHTML = `<option selected disabled>Choose Airport...</option>`;
    airportName.disabled = true;

    const snap = await getDocs(
      query(
        collection(db, "airports"),
        where("city", "==", city),
        where("is_active", "==", true)
      )
    );

    snap.forEach(docSnap => {
      const a = docSnap.data();
      const opt = document.createElement("option");
      opt.value = docSnap.id;
      opt.textContent = a.name;
      airportName.appendChild(opt);
    });

    airportName.disabled = false;
  }

  loadVenues();

  category.addEventListener("change", async () => {
    const selected = category.options[category.selectedIndex];
    const type = selected?.dataset.type;

    reserveBtn.disabled = true;
    updateButtonVisualState();

    if (type === "airport") {
      airportSection.style.display = "block";
      eventList.style.display = "none";
    } else {
      airportSection.style.display = "none";
      eventList.style.display = "block";
      await loadEventsForVenue(category.value);
    }
  });

  citySelect.addEventListener("change", () => {
    loadAirports(citySelect.value);
  });

  eventList.addEventListener('change',()=>{
    if(eventList.value!=='') reserveBtn.disabled=false;
    updateButtonVisualState();
  });

  reserveBtn.addEventListener("click", () => {
    if (!currentUser) {
      window.location.href = "login.html?redirect=index";
      return;
    }

    const venueId = category.value;
    const eventId = eventList.value || "";

    window.location.href = `reserve-a-spot.html?venue=${venueId}&event=${eventId}`;
  });

  function validateAirportForm() {
    const city = citySelect.value;
    const airport = airportName.value;
    const arrive = document.getElementById("arriveDate").value;
    const depart = document.getElementById("departDate").value;

    if (category.options[category.selectedIndex]?.dataset.type === "airport" && city && airport && arrive && depart) {
      reserveBtn.disabled = false;
    } else if (category.options[category.selectedIndex]?.dataset.type === "airport") {
      reserveBtn.disabled = true;
    }
  }

  ["change", "input"].forEach(evt => {
    citySelect.addEventListener(evt, validateAirportForm);
    airportName.addEventListener(evt, validateAirportForm);
    document.getElementById("arriveDate").addEventListener(evt, validateAirportForm);
    document.getElementById("departDate").addEventListener(evt, validateAirportForm);
  });

  function updateButtonVisualState() {
    if (!reserveBtn.disabled) {
      reserveBtn.classList.add("active");
      reserveBtn.style.backgroundColor = "#1f6351";
      reserveBtn.style.opacity = "1";
      reserveBtn.style.cursor = "pointer";
    } else {
      reserveBtn.classList.remove("active");
      reserveBtn.style.backgroundColor = "#b0b0b0";
      reserveBtn.style.opacity = "0.6";
      reserveBtn.style.cursor = "not-allowed";
    }
  }

  ["change", "input"].forEach(evt => {
    category.addEventListener(evt, updateButtonVisualState);
    eventList.addEventListener(evt, updateButtonVisualState);
    citySelect.addEventListener(evt, updateButtonVisualState);
    airportName.addEventListener(evt, updateButtonVisualState);
    document.getElementById("arriveDate").addEventListener(evt, updateButtonVisualState);
    document.getElementById("departDate").addEventListener(evt, updateButtonVisualState);
  });

  updateButtonVisualState();

  const radiusSelect = document.getElementById("radius");
  const findBtn = document.getElementById("findBtn");

  function validateNearbyForm() {
    const radius = radiusSelect.value;
    if (radius && radius !== "Select Range") {
      findBtn.disabled = false;
      findBtn.classList.add("active");
    } else {
      findBtn.disabled = true;
      findBtn.classList.remove("active");
    }
  }

  radiusSelect.addEventListener("change", validateNearbyForm);

  findBtn.addEventListener("click", () => {
    if (!findBtn.disabled) {
      const radius = radiusSelect.value || 3;
      window.location.href = `nearby-free.html?radius=${radius}`;
    }
  });

  const reserveTab=document.getElementById('reserveTab');
  const nearbyTab=document.getElementById('nearbyTab');
  const reserveForm=document.getElementById('reserveForm');
  const nearbyForm=document.getElementById('nearbyForm');
  reserveTab.onclick=()=>{reserveForm.style.display='block';nearbyForm.style.display='none';reserveTab.classList.add('active');nearbyTab.classList.remove('active');};
  nearbyTab.onclick=()=>{reserveForm.style.display='none';nearbyForm.style.display='block';nearbyTab.classList.add('active');reserveTab.classList.remove('active');};
</script>

</body>
</html>
